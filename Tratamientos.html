<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tratamientos - Clínica Salud Integral</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
     <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2e4a80;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --background-light: #ecf0f1;
            --text-dark: #2e4a80;
            --text-light: #7f8c8d;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --error-color: #e74c3c;
        }
        
        body {
            font-family: "Montserrat", sans-serif;
      font-optical-sizing: auto;
      font-weight: 300;
      font-style: normal;
      background-color: hsl(0, 0%, 100%);
      background-image: radial-gradient(800px circle at 100% 0%,
          hsl(211, 58%, 92%) 15%,
          hsl(210, 86%, 97%) 35%,
          hsl(223, 91%, 95%) 75%,
          hsl(214, 100%, 99%) 80%,
          transparent 100%),
          radial-gradient(600px circle at 0% 100%,
            hsl(202, 46%, 92%) 15%,
            hsl(0, 0%, 100%) 35%,
            hsl(210, 100%, 96%) 75%,
            hsl(216, 100%, 99%) 80%,
            transparent 100%);
      min-height: 100vh;
      padding: 20px;
        }
        
        /* Contenedor principal centrado */
        .main-container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
        }
        
            h1, h2, h3, h4, h5, h6 {
      font-family: "DM Sans", sans-serif;
      font-weight: 600;
    }
        /* Tarjeta de formulario */
        .form-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid #bdc3c7;
        }
        
        .form-header {
            background: linear-gradient(135deg, var(--primary-color), #1a446d);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        .form-body {
            padding: 30px;
        }
        
        /* Estilos del formulario */
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .form-label i {
            margin-right: 10px;
            color: var(--secondary-color);
        }
        
        .form-control, .form-select, .form-textarea {
            border-radius: 8px;
            padding: 12px 15px;
            border: 1px solid #bdc3c7;
            transition: all 0.3s;
            font-size: 1rem;
            width: 100%;
            color: var(--text-dark);
        }
        
        .form-control:focus, .form-select:focus, .form-textarea:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        /* Botones de acción centrados */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #bdc3c7;
            flex-wrap: wrap;
        }
        
        .btn-action {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 160px;
        }
        
        .btn-back {
            background: linear-gradient(135deg, var(--text-light), #95a5a6);
            color: white;
        }
        
        .btn-back:hover {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(127, 140, 141, 0.3);
            color: white;
        }
        
        .btn-save {
            background: linear-gradient(135deg, var(--success-color), #229954);
            color: white;
        }
        
        .btn-save:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
            color: white;
        }
        
        .btn-cancel {
            background: #f8f9fa;
            color: var(--text-light);
            border: 1px solid #bdc3c7;
        }
        
        .btn-cancel:hover {
            background: #e9ecef;
            color: var(--primary-color);
        }
        
        /* Estilos para validación */
        .error-message {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 5px;
            display: none;
        }
        
        .field-error {
            border-color: var(--error-color) !important;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-action {
                width: 100%;
                max-width: 250px;
            }
            
            body {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Formulario de tratamiento -->
        <div class="form-card">
            <div class="form-header">
                <h3 class="mb-0"><i class="fas fa-file-prescription me-2"></i>Nuevo Tratamiento</h3>
                <p class="mb-0 mt-2">Complete la información del tratamiento médico</p>
            </div>
            
            <div class="form-body">
                <form id="treatmentForm">
                    <!-- Información básica del tratamiento -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="treatmentId" class="form-label">
                                <i class="fas fa-id-card"></i> ID Tratamiento
                            </label>
                            <input type="text" class="form-control" id="treatmentId" value="TRA-2023-015" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="consultationId" class="form-label">
                                <i class="fas fa-stethoscope"></i> ID Consulta
                            </label>
                            <input type="text" class="form-control" id="consultationId" placeholder="Ej: CON-2023-XXX" required>
                            <div class="error-message" id="consultationIdError">Este campo es obligatorio</div>
                        </div>
                    </div>
                    
                    <!-- Medicamento y dosificación -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medication" class="form-label">
                                <i class="fas fa-capsules"></i> Medicamento
                            </label>
                            <input type="text" class="form-control" id="medication" placeholder="Nombre del medicamento" required>
                            <div class="error-message" id="medicationError">Este campo es obligatorio</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="dose" class="form-label">
                                <i class="fas fa-syringe"></i> Dosis
                            </label>
                            <input type="text" class="form-control" id="dose" placeholder="Ej: 500mg, 10UI, etc." required>
                            <div class="error-message" id="doseError">Este campo es obligatorio</div>
                        </div>
                    </div>
                    
                    <!-- Frecuencia y duración -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="frequency" class="form-label">
                                <i class="fas fa-clock"></i> Frecuencia
                            </label>
                            <select class="form-select" id="frequency" required>
                                <option value="">Seleccione la frecuencia</option>
                                <option value="una_vez_dia">Una vez al día</option>
                                <option value="dos_veces_dia">Dos veces al día</option>
                                <option value="tres_veces_dia">Tres veces al día</option>
                                <option value="cada_8_horas">Cada 8 horas</option>
                                <option value="cada_12_horas">Cada 12 horas</option>
                                <option value="semanal">Semanal</option>
                                <option value="mensual">Mensual</option>
                                <option value="segun_necesidad">Según necesidad</option>
                            </select>
                            <div class="error-message" id="frequencyError">Este campo es obligatorio</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="duration" class="form-label">
                                <i class="fas fa-calendar-alt"></i> Duración
                            </label>
                            <input type="text" class="form-control" id="duration" placeholder="Ej: 7 días, 1 mes, etc." required>
                            <div class="error-message" id="durationError">Este campo es obligatorio</div>
                        </div>
                    </div>
                    
                    <!-- Vía de administración y fechas -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="administrationRoute" class="form-label">
                                <i class="fas fa-route"></i> Vía de Administración
                            </label>
                            <select class="form-select" id="administrationRoute" required>
                                <option value="">Seleccione la vía</option>
                                <option value="oral">Oral</option>
                                <option value="subcutanea">Subcutánea</option>
                                <option value="intramuscular">Intramuscular</option>
                                <option value="intravenosa">Intravenosa</option>
                                <option value="topica">Tópica</option>
                                <option value="inhalada">Inhalada</option>
                                <option value="oftalmica">Oftálmica</option>
                                <option value="otica">Ótica</option>
                            </select>
                            <div class="error-message" id="administrationRouteError">Este campo es obligatorio</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="startDate" class="form-label">
                                <i class="fas fa-play-circle"></i> Fecha Inicio
                            </label>
                            <input type="date" class="form-control" id="startDate" required>
                            <div class="error-message" id="startDateError">Este campo es obligatorio</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="endDate" class="form-label">
                                <i class="fas fa-stop-circle"></i> Fecha Fin
                            </label>
                            <input type="date" class="form-control" id="endDate" required>
                            <div class="error-message" id="endDateError">Este campo es obligatorio</div>
                        </div>
                    </div>
                    
                    <!-- Indicaciones especiales -->
                    <div class="form-group">
                        <label for="instructions" class="form-label">
                            <i class="fas fa-clipboard-list"></i> Indicaciones Especiales
                        </label>
                        <textarea class="form-control form-textarea" id="instructions" placeholder="Indicaciones específicas para el paciente..."></textarea>
                    </div>
                </form>
                
                <!-- Botones de acción centrados -->
                <div class="action-buttons">
                    <button class="btn-action btn-back" onclick="window.location.href='detalle_paciente.html'">
                        <i class="fas fa-arrow-left me-2"></i> Regresar
                    </button>
                    <button class="btn-action btn-cancel" id="cancelButton" onclick="window.location.href='detalle_paciente.html'" >
                        <i class="fas fa-times me-2"></i> Cancelar
                    </button>
                    <button class="btn-action btn-save" id="saveButton">
                        <i class="fas fa-save me-2"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Variables globales para el estado del formulario
        let treatmentIdCounter = 15; // Simulación de contador para IDs únicos
        
        // Inicialización del formulario
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer fecha actual como valor por defecto para fecha de inicio
            document.getElementById('startDate').valueAsDate = new Date();
            
            // Calcular fecha de fin (30 días después por defecto)
            const endDate = new Date();
            endDate.setDate(endDate.getDate() + 30);
            document.getElementById('endDate').valueAsDate = endDate;
            
            // Generar ID de tratamiento automáticamente
            document.getElementById('treatmentId').value = generateTreatmentId();
            
            // Configurar eventos de validación en tiempo real
            setupRealTimeValidation();
        });
        
        // Configurar validación en tiempo real
        function setupRealTimeValidation() {
            const requiredFields = document.querySelectorAll('#treatmentForm [required]');
            
            requiredFields.forEach(field => {
                field.addEventListener('blur', function() {
                    validateField(this);
                });
                
                field.addEventListener('input', function() {
                    // Limpiar error cuando el usuario empiece a escribir
                    if (this.value.trim() !== '') {
                        clearFieldError(this);
                    }
                });
            });
            
            // Validación especial para fechas
            document.getElementById('startDate').addEventListener('change', validateDates);
            document.getElementById('endDate').addEventListener('change', validateDates);
        }
        
        // Validar un campo individual
        function validateField(field) {
            const errorElement = document.getElementById(field.id + 'Error');
            
            if (!field.value.trim()) {
                field.classList.add('field-error');
                if (errorElement) errorElement.style.display = 'block';
                return false;
            } else {
                clearFieldError(field);
                return true;
            }
        }
        
        // Limpiar error de un campo
        function clearFieldError(field) {
            field.classList.remove('field-error');
            const errorElement = document.getElementById(field.id + 'Error');
            if (errorElement) errorElement.style.display = 'none';
        }
        
        // Validación específica para fechas
        function validateDates() {
            const startDate = document.getElementById('startDate');
            const endDate = document.getElementById('endDate');
            const startDateError = document.getElementById('startDateError');
            const endDateError = document.getElementById('endDateError');
            
            // Validar que ambas fechas estén completas
            if (!startDate.value || !endDate.value) return;
            
            const start = new Date(startDate.value);
            const end = new Date(endDate.value);
            
            if (end <= start) {
                startDate.classList.add('field-error');
                endDate.classList.add('field-error');
                endDateError.textContent = 'La fecha de fin debe ser posterior a la fecha de inicio';
                endDateError.style.display = 'block';
                return false;
            } else {
                startDate.classList.remove('field-error');
                endDate.classList.remove('field-error');
                endDateError.style.display = 'none';
                return true;
            }
        }
        
        // Validación completa del formulario
        function validateForm() {
            const requiredFields = document.querySelectorAll('#treatmentForm [required]');
            let isValid = true;
            
            // Validar campos requeridos
            requiredFields.forEach(field => {
                if (!validateField(field)) {
                    isValid = false;
                }
            });
            
            // Validación adicional para fechas
            if (!validateDates()) {
                isValid = false;
            }
            
            return isValid;
        }
        
        // Generar ID de tratamiento único
        function generateTreatmentId() {
            const now = new Date();
            const year = now.getFullYear();
            treatmentIdCounter++; // Incrementar contador para evitar duplicados
            return `TRA-${year}-${treatmentIdCounter.toString().padStart(3, '0')}`;
        }
        
        // Guardar tratamiento
        function saveTreatment() {
            if (!validateForm()) {
                alert('Por favor, complete todos los campos requeridos correctamente');
                return;
            }
            
            if (confirm('¿Está seguro de que desea guardar este tratamiento?')) {
                // Simular envío del formulario
                alert('Tratamiento guardado correctamente');
                // Aquí iría la lógica real para guardar el tratamiento
                
                // Generar nuevo ID para el próximo tratamiento
                document.getElementById('treatmentId').value = generateTreatmentId();
            }
        }
        
        // Cancelar formulario
        function cancelForm() {
            if (confirm('¿Está seguro de que desea cancelar? Se perderán los datos no guardados.')) {
                document.getElementById('treatmentForm').reset();
                // Restablecer fechas
                document.getElementById('startDate').valueAsDate = new Date();
                const endDate = new Date();
                endDate.setDate(endDate.getDate() + 30);
                document.getElementById('endDate').valueAsDate = endDate;
                
                // Limpiar errores
                document.querySelectorAll('.error-message').forEach(error => {
                    error.style.display = 'none';
                });
                document.querySelectorAll('.field-error').forEach(field => {
                    field.classList.remove('field-error');
                });
            }
        }
        
        // Asignar eventos a los botones
        document.getElementById('saveButton').addEventListener('click', saveTreatment);
        document.getElementById('cancelButton').addEventListener('click', cancelForm);
    </script>
</body>
</html>